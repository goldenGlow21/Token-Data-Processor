write_then_throw()